[gcode_macro TEST_VARS]
variable_cancel_flag: 0
gcode:
    M118 This macro holds variables

[gcode_macro SET_TEST_VAR]
gcode:
    SET_GCODE_VARIABLE MACRO=TEST_VARS VARIABLE=cancel_flag VALUE=1
    M118 Variable set to 1

[gcode_macro CHECK_TEST_VAR]
gcode:
    M118 Variable value: {printer["gcode_macro TEST_VARS"].cancel_flag}

[gcode_macro RESET_TEST_VAR]
gcode:
    SET_GCODE_VARIABLE MACRO=TEST_VARS VARIABLE=cancel_flag VALUE=0
    M118 Variable reset to 0